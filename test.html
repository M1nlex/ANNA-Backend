<!doctype html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>ANNA backend test page</title>
	
	<style>
		.success { color: #006400; }
		.failure { color: #8B0000; }
	</style>
</head>
<body>
	<div id="tests">
		<h1>Test page</h1>
	</div>

	<script src="http://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
	<script type="text/javascript">
	function test(pages, protocol = "https", host = "localhost", port = 8080) {
		pages.forEach(function(curpage) {
			$("#tests").append('<span id="'+curpage.name+'">'+curpage.name+' : <span class="status">sending request</span></span><br>')
		
			var xhr = $.ajax({url : protocol+"://"+host+":"+port+curpage.url, method: curpage.method, data: curpage.params});
			xhr.testPage = curpage;

			xhr.done(function(data, status, jqxhr) {
				$("#"+jqxhr.testPage.name+" .status").text("response received");
				var test_result = jqxhr.testPage.test(data);
				if( test_result == true ){
					$("#"+jqxhr.testPage.name+" .status").text("OK");
				} else {
					$("#"+jqxhr.testPage.name+" .status").text("failed with return value : "+test_result);
				}
					
			});

			xhr.fail(function(data, status, error) {
				$("#"+xhr.testPage.name+" .Status").text("request failed : "+error);
			});
		});
	};
			
	pages = [
		{url : "/", name: "Connection", method: "GET", test: function(res){return true}},
		{url : "/login", name: "Login", method: "GET", params: {},  test: function(res){return true}},
		{url : "/blog", name: "Blog-list", method: "POST", params: {}, test: function(res){return true}},
		{url : "/blog", name: "Blog-details", method: "POST", params: {}, test: function(res){return true}},
		{url : "/log", name: "Log", method: "POST", params: {}, test: function(res){return true}}
		
	
		]

	test(pages);

	</script>
</body>
</html>

